Upgrades based on work done by Eth Wave @TrueWaveBreak